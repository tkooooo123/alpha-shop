(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-338b93fe"],{1775:function(t,e,a){"use strict";a("d6e3")},"4e5c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"categories-wrapper"},[!0===t.isLoading?e("spinner"):e("div",[1===t.state?e("form",{staticClass:"create-form",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createCategory.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v("名稱")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",name:"name",placeholder:"請輸入分類名稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),e("button",{staticClass:"submit-btn",attrs:{type:"submit"}},[t._v("新增")])]):2===t.state?e("form",{staticClass:"edit-form",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createCategory.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v("名稱")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",name:"name",placeholder:"請輸入分類名稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),e("button",{staticClass:"submit-btn",attrs:{type:"submit"}},[t._v("儲存")])]):e("button",{staticClass:"create-btn",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.handleState.apply(null,arguments)}}},[t._v(" 新增分類 ")]),e("div",{staticClass:"categoryList mt-4"},[e("table",{staticClass:"categoryList-table"},[!0===t.isProcessing?e("ProcessSpinner"):t._e(),e("thead",[e("tr",[e("th",[t._v("#")]),e("th",[t._v("名稱")]),e("th",[t._v("編輯/刪除")])])]),t._l(t.categories,(function(a){return e("tbody",{key:a.id,attrs:{id:a.id}},[e("tr",[e("td",{staticClass:"categoryList-category-id"},[t._v(" "+t._s(a.id)+" ")]),e("td",{staticClass:"categoryList-category-name"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!a.isEditing,expression:"!category.isEditing"}]},[t._v(" "+t._s(a.name)+" ")]),e("div",{staticClass:"input-wrapper"},[e("input",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"},{name:"model",rawName:"v-model",value:a.name,expression:"category.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.name},on:{input:function(e){e.target.composing||t.$set(a,"name",e.target.value)}}}),e("span",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"}],staticClass:"cancel",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.handleCancel(a.id)}}},[t._v(" ✕ ")])])]),e("td",{staticClass:"categoryList-btn"},[e("button",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"}],on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.updateCategory({categoryId:a.id,name:a.name})}}},[e("i",{staticClass:"fa fa-save fa-lg"})]),e("button",{directives:[{name:"show",rawName:"v-show",value:!a.isEditing,expression:"!category.isEditing"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleIsEditing(a.id)}}},[e("i",{staticClass:"fa fa-edit fa-lg"})]),e("button",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteCategory(a.id)}}},[e("i",{staticClass:"fa fa-trash fa-lg"})])])])])}))],2)])])],1)},i=[],s=(a("d9e2"),a("be6c")),n=a("2fa3"),o=a("2375"),c=a("c09c"),d={components:{Spinner:o["a"],ProcessSpinner:c["a"]},data(){return{categories:[],name:"",state:0,isLoading:!0,isProcessing:!1}},created(){this.fetchCategories()},methods:{async fetchCategories(){try{const t=await s["a"].getCategories(),{data:e}=t;if("error"===t.status)throw new Error(t.data.message);this.categories=e.categories.map(t=>({...t,isEditing:!1,nameCached:""})),this.isLoading=!1,this.isProcessing=!1}catch(t){this.isLoading=!1,n["a"].fire({icon:"error",title:"無法取得分類資料，請稍後再試"})}},async createCategory(){try{this.isProcessing=!0;const t=await s["a"].createCategory({name:this.name});if("error"===t.status)throw new Error(t.data.message);this.state=0,this.name="",this.fetchCategories()}catch(t){this.isProcessing=!1,n["a"].fire({icon:"error",title:"無法新增分類資料，請稍後再試"})}},async deleteCategory(t){try{this.isProcessing=!0;const e=await s["a"].deleteCategory({id:t});if("error"===e.status)throw new Error(e.data.message);document.getElementById(t).remove(),this.isProcessing=!1}catch(e){this.isProcessing=!1,n["a"].fire({icon:"error",title:"無法刪除分類資料，請稍後再試"})}},toggleIsEditing(t){this.categories=this.categories.map(e=>e.id===t?{...e,isEditing:!e.isEditing,nameCached:e.name}:{...e,isEditing:!1})},handleCancel(t){this.categories=this.categories.map(e=>e.id===t?{...e,name:e.nameCached}:e),this.toggleIsEditing(t)},async updateCategory({categoryId:t,name:e}){try{this.isProcessing=!0;const a=await s["a"].updateCategory({id:t,name:e});if("error"===a.status)throw new Error(a.data.message);this.toggleIsEditing(t),this.isProcessing=!1}catch(a){this.isProcessing=!1,n["a"].fire({icon:"error",title:"無法更新分類資料，請稍後再試"})}},handleState(){0===this.state?this.state++:this.state=0}}},g=d,u=(a("1775"),a("2877")),m=Object(u["a"])(g,r,i,!1,null,null,null);e["default"]=m.exports},be6c:function(t,e,a){"use strict";var r=a("2fa3");const i=()=>localStorage.getItem("token");e["a"]={getProducts({page:t,categoryId:e}){const a=new URLSearchParams({page:t,categoryId:e});return r["b"].get("/admin/products?"+a.toString(),{headers:{Authorization:"Bearer "+i()}})},getProduct({id:t}){return r["b"].get("/admin/products/"+t,{headers:{Authorization:"Bearer "+i()}})},putProduct({id:t,formData:e}){return r["b"].put("/admin/products/"+t,e,{headers:{Authorization:"Bearer "+i()}})},postProduct({formData:t}){return r["b"].post("/admin/product",t,{headers:{Authorization:"Bearer "+i()}})},deleteProduct({id:t}){return r["b"].delete(`/admin/products/${t}/delete`,{headers:{Authorization:"Bearer "+i()}})},getCategories(){return r["b"].get("/admin/categories",{headers:{Authorization:"Bearer "+i()}})},createCategory({name:t}){return r["b"].post("/admin/categories",{name:t},{headers:{Authorization:"Bearer "+i()}})},deleteCategory({id:t}){return r["b"].delete("/admin/categories/"+t,{headers:{Authorization:"Bearer "+i()}})},updateCategory({id:t,name:e}){return r["b"].put("/admin/categories/"+t,{name:e},{headers:{Authorization:"Bearer "+i()}})},getOrders({page:t}){const e=new URLSearchParams({page:t});return r["b"].get("/admin/orders?"+e.toString(),{headers:{Authorization:"Bearer "+i()}})},cancelOrder({id:t,data:e}){return r["b"].put(`/admin/orders/${t}/cancel`,{data:e},{headers:{Authorization:"Bearer "+i()}})},updateOrder({id:t,payment:e,shipment:a}){return r["b"].put("/admin/orders/"+t,{payment:e,shipment:a},{headers:{Authorization:"Bearer "+i()}})},getOrder({id:t}){return r["b"].get("/admin/orders/"+t,{headers:{Authorization:"Bearer "+i()}})}}},d6e3:function(t,e,a){}}]);
//# sourceMappingURL=chunk-338b93fe.c9fd0b77.js.map